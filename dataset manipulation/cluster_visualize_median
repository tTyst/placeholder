import pandas as pd

# Load the CSV file into a DataFrame
df = pd.read_csv('filtered_job_postings.csv')

# Ensure the 'cluster' column exists
if 'cluster' not in df.columns:
    raise KeyError("The DataFrame must contain a 'cluster' column.")

# Initialize a counter for the total number of job postings
total_postings = 0

# Analyze each cluster
for k in range(df['cluster'].nunique()):
    # Get data for the current cluster
    cluster_data = df[df['cluster'] == k]
    
    # Get the number of job postings in the current cluster
    cluster_postings = len(cluster_data)
    total_postings += cluster_postings
    
    print(f"\nCluster {k} Profile:")
    print(f"Number of job postings in cluster {k}: {cluster_postings}")
    
    # Print the mode (most frequent value) for categorical columns
    categorical_columns = cluster_data.select_dtypes(include=['object', 'category']).columns
    for col in categorical_columns:
        mode_value = cluster_data[col].mode()
        most_common = mode_value[0] if not mode_value.empty else "N/A"
        print(f"{col} (Most Common): {most_common}")

    # Print the mean and median for numerical columns
    numerical_columns = cluster_data.select_dtypes(include=['number']).columns
    for col in numerical_columns:
        mean_value = cluster_data[col].mean()
        median_value = cluster_data[col].median()
        print(f"{col} (Mean): {mean_value:.2f}")
        print(f"{col} (Median): {median_value:.2f}")

# Print the total number of job postings across all clusters
print(f"\nTotal number of job postings across all clusters: {total_postings}")
